var logi=0;function LOG(a){$('<div />').html(logi+' :: '+a).appendTo('body');logi++}function LOGO(obj){var a='';for(var i in obj){try{a+='<br/><b>'+i+"</b> = "+obj[i]+"\n"}catch(m){a+='<br/><b>'+i+"</b> -- not allowed -- \n"}}LOG(a)}gpadmin={uploadFile:function(el){el.parentNode.className='active';var t=el.value.toString();while(pos=t.search('\\\\')){if(pos==-1){break}t=t.substr(pos+1)}$('<div><a href="javascript:void(0)" onclick="gpadmin.rmFile(this)" >Remove</a><div class="name">'+t+'</div></div>').appendTo(el.parentNode);if($('#gp_upload_list .active').size()<5){gpadmin.addFile()}},addFile:function(){$('#gp_upload_field').clone().attr('id','').attr('class','upload_ready').appendTo('#gp_upload_list')},rmFile:function(el){$(el).closest('.active').remove();if($('#gp_upload_list .upload_ready').size()<1){gpadmin.addFile()}}};function createCookie(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString()}else var expires="";document.cookie=name+"="+value+expires+"; path=/"}function eraseCookie(name){createCookie(name,"",-1)}function jPrep(a,b){b=b||'gpreq=json&jsoncallback=?';a+=(a.indexOf('?')==-1)?'?':'&';return a+b}function ajaxResponse(data){for(i in data){var j=data[i];switch(j.DO){case'replace':$(j.SELECTOR).replaceWith(j.CONTENT);break;case'inner':$(j.SELECTOR).html(j.CONTENT);break;case'eval':eval(j.CONTENT);break;default:if(typeof(gpresponse[j.DO])=='function'){gpresponse[j.DO].call(this,j)}else{alert('nothing for: '+j.DO)}break}}try{$.fn.colorbox.close()}catch(er){}$.fn.gpeasy.LiveJQ();$('#loading').clearQueue().fadeOut()}$(function(){var gpids=1;var cl='';if(IE7){cl='IE7CLASS'}else{cl='STCLASS'}$('body').addClass(cl);var a=$('#gpadminpanel');if(a.size()>0){var b=$('body').prepend(a).prepend('<div id="gpspace" />');a.show();$('div#gpspace').css('height',a.height())}eraseCookie('cookie_cmd');window.setTimeout(function(){cInit(),adminInit()},100);function adminInit(){if(!isadmin){return}var tmp4=$('<div id="editable_bar">&nbsp;</div>').appendTo('body');var leftWidth=0;$('a.ExtraEditLink').each(function(a,b){$b=$(b);var id=gpids++;$b.closest('.editable_area').attr('id','EditableArea_'+id).data('cid',id);var t=b.title.replace(/_/g,' ');if(t.length>15){t=t.substr(0,14)+'...'}var c=$b.clone(true).data('cid',id).addClass('editable_mark').removeClass('ExtraEditLink').text(t).appendTo('body');var w=c.outerWidth();if(leftWidth<w){leftWidth=w}c.css({left:0,right:0}).appendTo(tmp4);$(b).hide()});$('#edit_list_new, #editable_bar').hover(function(){$('#editable_bar').stop(true).fadeTo('fast',1.0).animate({width:leftWidth})},function(){$('#editable_bar').stop(true).fadeTo('fast',1.0).animate({width:'7px'},1300)});function reposition(){var bht=$('body').height();var wht=$(window).height();if(bht>wht){wht=bht}$('#editable_bar').css('height',wht);var position=Array();$('.editable_mark').each(function(a,b){var id=$(b).data('cid');var c=$('#EditableArea_'+id);if(c.length==0){return}var top=c.offset().top;top=Math.round(top/20)*20;while(position[top]){top+=20}position[top]=true;b.style.top=top+'px'})}reposition();window.setInterval(reposition,5000);$('.editable_area').bind('mousemove',function(){$this=$(this);$this.find('.ExtraEditLink').show();AreaOverlay($this);$('.edit_area_overlay').stop(true,true).delay(1000).fadeOut(700)}).bind('mouseleave',function(){$(this).find('.ExtraEditLink').hide();$('.edit_area_overlay').hide()});$('.editable_mark').hover(function(){var id=$(this).data('cid');c=$('#EditableArea_'+id);if(c.length==0){return}var a=$('#editable_bar');var right=(c.offset().left+c.width()-20);if(right<a.width()){$('#editable_bar').fadeTo('slow',.5)}AreaOverlay(c)},function(){$('.edit_area_overlay').hide();$('#editable_bar').fadeTo('fast',1.0)});function AreaOverlay(c){$('.edit_area_overlay').stop(true).fadeTo(10,1.0);var topleft=c.offset();var w=c.width();var h=c.height();if(h==0){var origin=c.offset();var maxy=0;var y=0;c.children().each(function(d,e){e=$(e);y=e.offset().top+e.height();if(y>maxy){maxy=y}});h=Math.max(0,y-origin.top)}$('#edit_area_overlay_top').css({'top':(topleft.top-24),'left':(topleft.left)}).height(22).width(w+2).show();$('#edit_area_overlay_right').css({'top':(topleft.top),'left':(topleft.left+w)}).height(h+2).width(22).show();$('#edit_area_overlay_bottom').css({'top':(topleft.top+h+2),'left':(topleft.left)}).height(22).width(w+2).show();$('#edit_area_overlay_left').css({'top':(topleft.top-2),'left':(topleft.left-24)}).height(h+6).width(22).show()}}function cInit(){$().ajaxError(function(event,XMLHttpRequest,ajaxOptions,thrownError){LOGO(XMLHttpRequest);alert('Error fetching response. Reload this page to continue.')});$('form').live('mousedown',function(e){$this=$(this);if($this.data('gpForms')=='checked'){return}if(typeof(this['return'])!=='undefined'){this['return'].value=window.location}$this.data('gpForms','checked')});$('input').live('click',function(e){$this=$(this);var a=$this.attr('class');switch(a){case'gppost':case'gpajax':return gpPublic.post(this);default:if(typeof(gpinputs[a])=='function'){return gpinputs[a].call(this)}return true}return false});$.fn.gpeasy.LiveJQ();$('a[name]').live('click',function(e){var a=$(this).attr('name');var b=$(this).attr('rel');switch(a){case'ajax_box':$.fn.colorbox({opacity:0.75,href:jPrep(this.href,'gpreq=flush'),open:true,maxWidth:"90%",minWidth:"300",minHeight:"300"});break;case'inline_box':var c=$(b).find('form').get(0);if(c){$(this).find('input').each(function(i,j){if(c[j.name]){c[j.name].value=j.value}})}$.fn.colorbox({opacity:0.75,inline:true,href:b,open:true,maxWidth:"90%",minWidth:"300",minHeight:"300"});break;case'gpajax':$.fn.gpeasy.jGoTo(this.href);break;case'creq':$.fn.gpeasy.cGoTo(this.search);break;case'close_message':this.parentNode.style.display='none';break;case'gallery':var c='a[rel='+b+']';var hmm=$(c).colorbox({opacity:0.75,maxWidth:"90%",maxHeight:"90%",resize:true,minWidth:"300",minHeight:"300"});$.fn.colorbox.launch(this);break;default:if(typeof(gplinks[a])=='function'){return gplinks[a].call(this);break}return true}e.preventDefault();return false})}function loading(){$('body').prepend($('#loading').css({'zIndex':'9001000'}).fadeTo('slow',.4))}var gpPublic;gpPublic=$.fn.gpeasy=function(){return this};gpPublic.jGoTo=function(a){loading();a=jPrep(a);$.getJSON(a,ajaxResponse)};gpPublic.cGoTo=function(a){createCookie('cookie_cmd',encodeURIComponent(a),1);var b=window.location.href;window.location=b};gpPublic.post=function(a){loading();var frm=$(a).closest('form');var c=jPrep(frm.attr('action'));$.post(c,frm.serialize(),ajaxResponse,'json');return false};gpPublic.LiveJQ=function(){$('.expand_child').unbind('mouseenter.live').unbind('mouseleave.live').bind('mouseenter.live',function(){$(this).addClass('expand');if($(this).hasClass('simple_top')){$(this).addClass('simple_top_hover')}}).bind('mouseleave.live',function(){$(this).removeClass('expand').removeClass('simple_top_hover')})}});