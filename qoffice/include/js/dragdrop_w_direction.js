WBd={scroll:false,scrolly:0,scrollx:0,scrolle:false,DMU:function(e){var a=$('.drag_target');if(a.size()<1){WBd.clean();return}var b=a.get(0);if(!b||(b==WBd.dragEl)){WBd.clean();return}b=b.firstChild;var lnk=$(WBd.dragEl).children(':first').clone(true);if(lnk.size()<1){WBd.clean();return}lnk.attr('href',lnk.attr('href').replace('%s',b.innerHTML));lnk.click();WBd.clean()},clean:function(){$('body').removeClass('drag_active');$('.WB_DRAG_BOX').hide();$(document).unbind('mousemove.drag',WBd.DMM).unbind('mouseup.drag',WBd.DMU);$('.draggable_element').unbind('mouseover.drag').unbind('mouseout.drag').removeClass('drag_target');WBd.VARS()},VARS:function(){WBd.dragEl=false;WBd.target=false;WBd.Toffset=false;WBd.Theight=false;WBd.Twidth=false;WBd.Tangle=false},dMDn:function(e){var b,c,l;if($(e.target).closest('.expand ul').size()>0){return}$(document).bind('mouseup.drag',WBd.DMU);var a=WBd.dragEl=this;var margx=(a.offsetWidth/2);var margy=(a.offsetHeight/2);$('#WB_DRAG_BOX_TOP').height('30px').width(a.offsetWidth).css('marginTop',-(margy+30)).css('marginLeft',-margx);$('#WB_DRAG_BOX_BOTTOM').width(a.offsetWidth).css('marginTop',margy).css('marginLeft',-margx);$('#WB_DRAG_BOX_LEFT').height(a.offsetHeight).width(1).css('marginTop',-margy).css('marginLeft',-margx);$('#WB_DRAG_BOX_RIGHT').height(a.offsetHeight).width(1).css('marginTop',-margy).css('marginLeft',margx);$(this).before('<div id="WB_DRAG_PLACEHOLDER"/>');$('.draggable_element').bind('mouseenter.drag',function(){WBd.target=$(this).addClass('drag_target');WBd.Toffset=WBd.target.offset();WBd.Theight=WBd.target.height();WBd.Twidth=WBd.target.width();WBd.Tangle=WBd.Theight/WBd.Twidth;$(WBd.target).before(WBd.dragEl)}).bind('mouseleave.drag',function(){$(this).removeClass('drag_target');WBd.target=false;WBd.Toffset=false;WBd.Theight=false;WBd.Twidth=false;WBd.Tangle=false;$('#WB_DRAG_PLACEHOLDER').after(WBd.dragEl)});$(document).bind('mousemove.drag',WBd.DMM);WBd.DMM(e);$('.WB_DRAG_BOX').show();return false},DMM:function(e){if(!e)return;var wx,wy,x,y;var wn=$(window);wx=(e.clientX+wn.scrollLeft());wy=(e.clientY+wn.scrollTop());$('.WB_DRAG_BOX').css('left',wx).css('top',wy);x=y=0;if(e.clientY<80){y=-20}else if((e.clientY+60)>wn.height()){y=20}if(e.clientX<60){x=-20}else if((e.clientX+60)>wn.width()){x=20}if((x===0)&&(y==0)){WBd.SCR()}else{WBd.scrollx=x;WBd.scrolly=y;WBd.scrolle=e;if(WBd.scroll===false){WBd.scroll=window.setInterval(function(){if(!WBd.dragEl){WBd.SCR();return}window.scrollBy(WBd.scrollx,WBd.scrolly);WBd.DMM(WBd.scrolle)},150)}}if(!WBd.target){return false}var tyc=WBd.Toffset.top+(WBd.Theight/2);var txc=WBd.Toffset.left+(WBd.Twidth/2);var pointAngle=(tyc-wy)/(txc-wx);var where='top';if(wy<tyc){if((pointAngle<-WBd.Tangle)||(pointAngle>WBd.Tangle)){where='top'}else if(pointAngle<0){where='right '}else{where='left'}}else{if((pointAngle<-WBd.Tangle)||(pointAngle>WBd.Tangle)){where='bottom'}else if(pointAngle<0){where='left '}else{where='right'}}window.status=where;return false},SCR:function(){if(WBd.scroll){window.clearInterval(WBd.scroll)}WBd.scroll=WBd.scrolle=false}};$(function(){WBd.VARS();$('.draggable_element').live('mousedown',WBd.dMDn);var a=$('<div style="position:absolute;z-index:10000;cursor:move;display:none;" class="WB_DRAG_BOX"></div>');a.clone().css('borderBottom','2px dashed #bbb').attr('id','WB_DRAG_BOX_TOP').appendTo('body');a.clone().css('borderLeft','2px dashed #bbb').attr('id','WB_DRAG_BOX_LEFT').appendTo('body');a.clone().css('borderTop','2px dashed #bbb').attr('id','WB_DRAG_BOX_BOTTOM').appendTo('body');a.clone().css('borderRight','2px dashed #bbb').attr('id','WB_DRAG_BOX_RIGHT').appendTo('body')});